unit ComprarCartones;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, lo_hashabierto, lo_dobleenlace, la_dobleEnlace,
  Vcl.StdCtrls, Globals;

type
  TFormComprarCartones = class(TForm)
    Label1: TLabel;
    LabelJuego: TLabel;
    Label2: TLabel;
    EditCartones: TEdit;
    ButtonComprar: TButton;
   
    procedure ButtonComprarClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    JuegoActual: tRegDatosHash;
  end;

var
  FormComprarCartones: TFormComprarCartones;

implementation

{$R *.dfm}

procedure TFormComprarCartones.ButtonComprarClick(Sender: TObject);
var
  buttonSelected,i,cantidadCartones : Integer;
  precioTotal: real;
  grilla : tMatriz;
begin
  cantidadCartones := strtoint(editcartones.Text);
  precioTotal:= cantidadCartones*JuegoActual.ValorVenta;
   buttonSelected := messagedlg('El precio es $'+FloatToStr(strtoint(editcartones.Text)*JuegoActual.ValorVenta)+' por los '+editcartones.Text+' cartones.'+' Está seguro que desea realizar la compra?',mtError, mbOKCancel, 0);
   if buttonSelected = mrOK     then
   begin
     //generar cartones,
     for I := 0 to cantidadCartones-1 do
     begin
       repeat
         grilla:= generarGrilla();
       until (not isGrillaEnMe(MeCartones, grilla));

       //falta chequear que la grilla no exista ya ( hacerlo en LA)
       altaCarton(Globals.JugadorLogueado.clave, grilla);
     end;
     //cambiar cant cartones vendidos del juego,

     //tirarle msg compra realizada con exito
   end;
end;



end.
